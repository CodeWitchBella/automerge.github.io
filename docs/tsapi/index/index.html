<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Automerge CRDT RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Automerge CRDT Atom Feed"><title data-react-helmet="true">@automerge/automerge | Automerge CRDT</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://automerge.github.io/docs/tsapi/index/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="@automerge/automerge | Automerge CRDT"><meta data-react-helmet="true" name="description" content="This library provides the core automerge data structure and sync algorithms."><meta data-react-helmet="true" property="og:description" content="This library provides the core automerge data structure and sync algorithms."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://automerge.github.io/docs/tsapi/index/"><link data-react-helmet="true" rel="alternate" href="https://automerge.github.io/docs/tsapi/index/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://automerge.github.io/docs/tsapi/index/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.82e2244f.css">
<link rel="preload" href="/assets/js/runtime~main.9e1d470a.js" as="script">
<link rel="preload" href="/assets/js/main.f8e721d1.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/automerge.png" alt="Automerge logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/automerge.png" alt="Automerge logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Automerge</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/hello/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/automerge" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/hello/">Welcome to Automerge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quickstart/">5-Minute Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorial</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Types</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cookbook</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Internals</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">API Docs</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tsapi/index/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Namespaces</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Classes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Interfaces</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/api/">Other APIs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/glossary/">Glossary</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Automerge</h1></header><p>This library provides the core automerge data structure and sync algorithms.
Other libraries can be built on top of this one which provide IO and
persistence.</p><p>An automerge document can be though of an immutable POJO (plain old javascript
object) which <code>automerge</code> tracks the history of, allowing it to be merged with
any other automerge document.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="creating-and-modifying-a-document">Creating and modifying a document<a aria-hidden="true" class="hash-link" href="#creating-and-modifying-a-document" title="Direct link to heading">â€‹</a></h2><p>You can create a document with <a href="#init">init</a> or <a href="#from">from</a> and then make
changes to it with <a href="#change-1">change</a>, you can merge two documents with <a href="#merge">merge</a>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports operator" style="color:#393A34">*</span><span class="token imports"> </span><span class="token imports keyword" style="color:#00009f">as</span><span class="token imports"> automerge</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@automerge/automerge&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name">DocType</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">ideas</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Text</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> doc1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generic-function function" style="color:#d73a49">init</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name maybe-class-name">DocType</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">change</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> d </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ideas</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">Text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;an immutable document&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> doc2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generic-function function" style="color:#d73a49">init</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name maybe-class-name">DocType</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">merge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generic-function function" style="color:#d73a49">change</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name maybe-class-name">DocType</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> d </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ideas</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">Text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;which records it&#x27;s history&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Note the `automerge.clone` call, see the &quot;cloning&quot; section of this readme for</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// more detail</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">merge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">change</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> d </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ideas</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">deleteAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ideas</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">insertAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;object&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> doc3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">merge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> doc2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// doc3 is now {ideas: [&quot;an immutable object&quot;, &quot;which records it&#x27;s history&quot;]}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="applying-changes-from-another-document">Applying changes from another document<a aria-hidden="true" class="hash-link" href="#applying-changes-from-another-document" title="Direct link to heading">â€‹</a></h2><p>You can get a representation of the result of the last <a href="#change-1">change</a> you made
to a document with <a href="#getlastlocalchange">getLastLocalChange</a> and you can apply that change to
another document using <a href="#applychanges">applyChanges</a>.</p><p>If you need to get just the changes which are in one document but not in another
you can use <a href="#getheads">getHeads</a> to get the heads of the document without the
changes and then <a href="#getmissingdeps">getMissingDeps</a>, passing the result of <a href="#getheads">getHeads</a>
on the document with the changes.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="saving-and-loading-documents">Saving and loading documents<a aria-hidden="true" class="hash-link" href="#saving-and-loading-documents" title="Direct link to heading">â€‹</a></h2><p>You can <a href="#save">save</a> a document to generate a compresed binary representation of
the document which can be loaded with <a href="#load">load</a>. If you have a document which
you have recently made changes to you can generate recent changes with saveIncremental, this will generate all the changes since you last called
<code>saveIncremental</code>, the changes generated can be applied to another document with
<a href="#loadincremental">loadIncremental</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="viewing-different-versions-of-a-document">Viewing different versions of a document<a aria-hidden="true" class="hash-link" href="#viewing-different-versions-of-a-document" title="Direct link to heading">â€‹</a></h2><p>Occasionally you may wish to explicitly step to a different point in a document
history. One common reason to do this is if you need to obtain a set of changes
which take the document from one state to another in order to send those changes
to another peer (or to save them somewhere). You can use <a href="#view">view</a> to do this.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports operator" style="color:#393A34">*</span><span class="token imports"> </span><span class="token imports keyword" style="color:#00009f">as</span><span class="token imports"> automerge</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@automerge/automerge&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports operator" style="color:#393A34">*</span><span class="token imports"> </span><span class="token imports keyword" style="color:#00009f">as</span><span class="token imports"> assert</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;assert&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> doc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  key1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;value1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Make a clone of the document at this point, maybe this is actually on another</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// peer.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> doc2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">clone</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> doc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> heads </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getHeads</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generic-function function" style="color:#d73a49">change</span><span class="token generic-function"> </span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name"></span><br></span><span class="token-line" style="color:#393A34"><span class="token generic-function generic class-name">  </span><span class="token generic-function generic class-name builtin">any</span><span class="token generic-function generic class-name"> </span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  d </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;value2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generic-function function" style="color:#d73a49">change</span><span class="token generic-function"> </span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name"></span><br></span><span class="token-line" style="color:#393A34"><span class="token generic-function generic class-name">  </span><span class="token generic-function generic class-name builtin">any</span><span class="token generic-function generic class-name"> </span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  d </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;value3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// At this point we&#x27;ve generated two separate changes, now we want to send</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// just those changes to someone else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// view is a cheap reference based copy of a document at a given set of heads</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> before </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">view</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> heads</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// This view doesn&#x27;t show the last two changes in the document state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">deepEqual</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">before</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  key1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;value1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Get the changes to send to doc2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> changes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getChanges</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">before</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> doc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Apply the changes at doc2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generic-function function" style="color:#d73a49">applyChanges</span><span class="token generic-function"> </span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name"> </span><span class="token generic-function generic class-name builtin">any</span><span class="token generic-function generic class-name"> </span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> changes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">deepEqual</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  key1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;value1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  key2</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;value2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  key3</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;value3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If you have a <a href="#view">view</a> of a document which you want to make changes to you
can <a href="#clone">clone</a> the viewed document.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="syncing">Syncing<a aria-hidden="true" class="hash-link" href="#syncing" title="Direct link to heading">â€‹</a></h2><p>The sync protocol is stateful. This means that we start by creating a <a href="/docs/tsapi/interfaces/SyncState/">SyncState</a> for each peer we are communicating with using <a href="#initsyncstate">initSyncState</a>.
Then we generate a message to send to the peer by calling <a href="#generatesyncmessage">generateSyncMessage</a>. When we receive a message from the peer we call <a href="#receivesyncmessage">receiveSyncMessage</a>. Here&#x27;s a simple example of a loop which just keeps two
peers in sync.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> sync1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">initSyncState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> msg</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Uint8Array</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">sync1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">generateSyncMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sync1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    network</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> resp</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Uint8Array</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">network</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">receive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sync1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _ignore</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">receiveSyncMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sync1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> resp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sync1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">generateSyncMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sync1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="conflicts">Conflicts<a aria-hidden="true" class="hash-link" href="#conflicts" title="Direct link to heading">â€‹</a></h2><p>The only time conflicts occur in automerge documents is in concurrent
assignments to the same key in an object. In this case automerge
deterministically chooses an arbitrary value to present to the application but
you can examine the conflicts using <a href="#getconflicts">getConflicts</a>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">import * as automerge from &quot;@automerge/automerge&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type Profile = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pets: Array&lt;{name: string, type: string}&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let doc1 = automerge.init&lt;Profile&gt;(&quot;aaaa&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc1 = automerge.change(doc1, d =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d.pets = [{name: &quot;Lassie&quot;, type: &quot;dog&quot;}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let doc2 = automerge.init&lt;Profile&gt;(&quot;bbbb&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc2 = automerge.merge(doc2, automerge.clone(doc1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc2 = automerge.change(doc2, d =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d.pets[0].name = &quot;Beethoven&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc1 = automerge.change(doc1, d =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d.pets[0].name = &quot;Babe&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const doc3 = automerge.merge(doc1, doc2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Note that here we pass `doc3.pets`, not `doc3`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let conflicts = automerge.getConflicts(doc3.pets[0], &quot;name&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// The two conflicting values are the keys of the conflicts object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert.deepEqual(Object.values(conflicts), [&quot;Babe&quot;, Beethoven&quot;])</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="actor-ids">Actor IDs<a aria-hidden="true" class="hash-link" href="#actor-ids" title="Direct link to heading">â€‹</a></h2><p>By default automerge will generate a random actor ID for you, but most methods
for creating a document allow you to set the actor ID. You can get the actor ID
associated with the document by calling <a href="#getactorid">getActorId</a>. Actor IDs must not
be used in concurrent threads of executiong - all changes by a given actor ID
are expected to be sequential.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="listening-to-patches">Listening to patches<a aria-hidden="true" class="hash-link" href="#listening-to-patches" title="Direct link to heading">â€‹</a></h2><p>Sometimes you want to respond to changes made to an automerge document. In this
case you can use the <a href="#patchcallback">PatchCallback</a> type to receive notifications when
changes have been made.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="cloning">Cloning<a aria-hidden="true" class="hash-link" href="#cloning" title="Direct link to heading">â€‹</a></h2><p>Currently you cannot make mutating changes (i.e. call <a href="#change-1">change</a>) to a
document which you have two pointers to. For example, in this code:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> doc1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> doc2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">change</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token parameter">d</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;value&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>doc1</code> and <code>doc2</code> are both pointers to the same state. Any attempt to call
mutating methods on <code>doc1</code> will now result in an error like</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to change an out of date document</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If you encounter this you need to clone the original document, the above sample
would work as:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> doc1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> doc2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">change</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">automerge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token parameter">d</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;value&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="the-unstable-module">The <a href="/docs/tsapi/namespaces/unstable/">unstable</a> module<a aria-hidden="true" class="hash-link" href="#the-unstable-module" title="Direct link to heading">â€‹</a></h2><p>We are working on some changes to automerge which are not yet complete and
will result in backwards incompatible API changes. Once these changes are
ready for production use we will release a new major version of automerge.
However, until that point you can use the <a href="/docs/tsapi/namespaces/unstable/">unstable</a> module to try out
the new features, documents from the <a href="/docs/tsapi/namespaces/unstable/">unstable</a> module are
interoperable with documents from the main module. Please see the docs for
the <a href="/docs/tsapi/namespaces/unstable/">unstable</a> module for more details.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="namespaces">Namespaces<a aria-hidden="true" class="hash-link" href="#namespaces" title="Direct link to heading">â€‹</a></h2><ul><li><a href="/docs/tsapi/namespaces/unstable/">unstable</a></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="classes">Classes<a aria-hidden="true" class="hash-link" href="#classes" title="Direct link to heading">â€‹</a></h2><ul><li><a href="/docs/tsapi/classes/Text/">Text</a></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="interfaces">Interfaces<a aria-hidden="true" class="hash-link" href="#interfaces" title="Direct link to heading">â€‹</a></h2><ul><li><a href="/docs/tsapi/interfaces/API/">API</a></li><li><a href="/docs/tsapi/interfaces/List/">List</a></li><li><a href="/docs/tsapi/interfaces/SyncState/">SyncState</a></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="references">References<a aria-hidden="true" class="hash-link" href="#references" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="counter">Counter<a aria-hidden="true" class="hash-link" href="#counter" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/classes/unstable.Counter/">Counter</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="delpatch">DelPatch<a aria-hidden="true" class="hash-link" href="#delpatch" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/namespaces/unstable/#delpatch">DelPatch</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="doc">Doc<a aria-hidden="true" class="hash-link" href="#doc" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/namespaces/unstable/#doc">Doc</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="float64">Float64<a aria-hidden="true" class="hash-link" href="#float64" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/classes/unstable.Float64/">Float64</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="incpatch">IncPatch<a aria-hidden="true" class="hash-link" href="#incpatch" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/namespaces/unstable/#incpatch">IncPatch</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="insertpatch">InsertPatch<a aria-hidden="true" class="hash-link" href="#insertpatch" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/namespaces/unstable/#insertpatch">InsertPatch</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="int">Int<a aria-hidden="true" class="hash-link" href="#int" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/classes/unstable.Int/">Int</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="patch">Patch<a aria-hidden="true" class="hash-link" href="#patch" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/namespaces/unstable/#patch">Patch</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="patchcallback">PatchCallback<a aria-hidden="true" class="hash-link" href="#patchcallback" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/namespaces/unstable/#patchcallback">PatchCallback</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="putpatch">PutPatch<a aria-hidden="true" class="hash-link" href="#putpatch" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/namespaces/unstable/#putpatch">PutPatch</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="splicetextpatch">SpliceTextPatch<a aria-hidden="true" class="hash-link" href="#splicetextpatch" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/namespaces/unstable/#splicetextpatch">SpliceTextPatch</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="syncmessage">SyncMessage<a aria-hidden="true" class="hash-link" href="#syncmessage" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/namespaces/unstable/#syncmessage">SyncMessage</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="uint">Uint<a aria-hidden="true" class="hash-link" href="#uint" title="Direct link to heading">â€‹</a></h3><p>Re-exports <a href="/docs/tsapi/classes/unstable.Uint/">Uint</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="type-aliases">Type Aliases<a aria-hidden="true" class="hash-link" href="#type-aliases" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="actorid">ActorId<a aria-hidden="true" class="hash-link" href="#actorid" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>ActorId</strong>: <code>string</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in" title="Direct link to heading">â€‹</a></h4><p>node_modules/@automerge/automerge-wasm/index.d.ts:1</p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="applyoptions">ApplyOptions<a aria-hidden="true" class="hash-link" href="#applyoptions" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>ApplyOptions</strong>&lt;<code>T</code>&gt;<!-- -->: <code>Object</code></p><p>Options passed to <a href="#loadincremental">loadIncremental</a>, <a href="#applychanges">applyChanges</a>, and <a href="#receivesyncmessage">receiveSyncMessage</a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="left">The type of value contained in the document</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-declaration">Type declaration<a aria-hidden="true" class="hash-link" href="#type-declaration" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>patchCallback?</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#patchcallback"><code>PatchCallback</code></a>&lt;<code>T</code>&gt;</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-1">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-1" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L74" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:74</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="automergevalue">AutomergeValue<a aria-hidden="true" class="hash-link" href="#automergevalue" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>AutomergeValue</strong>: <a href="#scalarvalue"><code>ScalarValue</code></a> <!-- -->|<!-- --> { <code>[key: string]</code>: <a href="#automergevalue"><code>AutomergeValue</code></a>;  } <!-- -->|<!-- --> <a href="#automergevalue"><code>AutomergeValue</code></a>[] <!-- -->|<!-- --> <a href="/docs/tsapi/classes/Text/"><code>Text</code></a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-2">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-2" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/types.ts#L10" target="_blank" rel="noopener noreferrer">automerge/javascript/src/types.ts:10</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="change">Change<a aria-hidden="true" class="hash-link" href="#change" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>Change</strong>: <code>Uint8Array</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-3">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-3" title="Direct link to heading">â€‹</a></h4><p>node_modules/@automerge/automerge-wasm/index.d.ts:3</p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="changefn">ChangeFn<a aria-hidden="true" class="hash-link" href="#changefn" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>ChangeFn</strong>&lt;<code>T</code>&gt;<!-- -->: (<code>doc</code>: <a href="#extend"><code>Extend</code></a>&lt;<code>T</code>&gt;<!-- -->) =&gt; <code>void</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-1">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-1" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="left">The type of value contained in the document  This function may mutate <code>doc</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-declaration-1">Type declaration<a aria-hidden="true" class="hash-link" href="#type-declaration-1" title="Direct link to heading">â€‹</a></h4><p>â–¸ (<code>doc</code>): <code>void</code></p><p>Function which is called by <a href="#change-1">change</a> when making changes to a <code>Doc&lt;T&gt;</code></p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="parameters">Parameters<a aria-hidden="true" class="hash-link" href="#parameters" title="Direct link to heading">â€‹</a></h5><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="#extend"><code>Extend</code></a>&lt;<code>T</code>&gt;</td></tr></tbody></table><h5 class="anchor anchorWithStickyNavbar_y2LR" id="returns">Returns<a aria-hidden="true" class="hash-link" href="#returns" title="Direct link to heading">â€‹</a></h5><p><code>void</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-4">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-4" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L105" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:105</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="changeoptions">ChangeOptions<a aria-hidden="true" class="hash-link" href="#changeoptions" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>ChangeOptions</strong>&lt;<code>T</code>&gt;<!-- -->: <code>Object</code></p><p>Options passed to <a href="#change-1">change</a>, and <a href="#emptychange">emptyChange</a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-2">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-2" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="left">The type of value contained in the document</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-declaration-2">Type declaration<a aria-hidden="true" class="hash-link" href="#type-declaration-2" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>message?</code></td><td align="left"><code>string</code></td><td align="left">A message which describes the changes</td></tr><tr><td align="left"><code>patchCallback?</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#patchcallback"><code>PatchCallback</code></a>&lt;<code>T</code>&gt;</td><td align="left">A callback which will be called to notify the caller of any changes to the document</td></tr><tr><td align="left"><code>time?</code></td><td align="left"><code>number</code></td><td align="left">The unix timestamp of the change (purely advisory, not used in conflict resolution)</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-5">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-5" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L62" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:62</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="conflicts-1">Conflicts<a aria-hidden="true" class="hash-link" href="#conflicts-1" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>Conflicts</strong>: <code>Object</code></p><p>The type of conflicts for particular key or index</p><p>Maps and sequences in automerge can contain conflicting values for a
particular key or index. In this case <a href="#getconflicts">getConflicts</a> can be used to
obtain a <code>Conflicts</code> representing the multiple values present for the property</p><p>A <code>Conflicts</code> is a map from a unique (per property or index) key to one of
the possible conflicting values for the given property.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="index-signature">Index signature<a aria-hidden="true" class="hash-link" href="#index-signature" title="Direct link to heading">â€‹</a></h4><p>â–ª <!-- -->[key: <code>string</code>]<!-- -->: <a href="#automergevalue"><code>AutomergeValue</code></a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-6">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-6" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L568" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:568</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="decodedchange">DecodedChange<a aria-hidden="true" class="hash-link" href="#decodedchange" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>DecodedChange</strong>: <code>Object</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-declaration-3">Type declaration<a aria-hidden="true" class="hash-link" href="#type-declaration-3" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>actor</code></td><td align="left"><a href="#actorid"><code>ActorId</code></a></td></tr><tr><td align="left"><code>deps</code></td><td align="left"><a href="#heads"><code>Heads</code></a></td></tr><tr><td align="left"><code>hash</code></td><td align="left"><code>Hash</code></td></tr><tr><td align="left"><code>message</code></td><td align="left"><code>string</code> <!-- -->|<!-- --> <code>null</code></td></tr><tr><td align="left"><code>ops</code></td><td align="left"><code>Op</code>[]</td></tr><tr><td align="left"><code>seq</code></td><td align="left"><code>number</code></td></tr><tr><td align="left"><code>startOp</code></td><td align="left"><code>number</code></td></tr><tr><td align="left"><code>time</code></td><td align="left"><code>number</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-7">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-7" title="Direct link to heading">â€‹</a></h4><p>node_modules/@automerge/automerge-wasm/index.d.ts:74</p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="decodedsyncmessage">DecodedSyncMessage<a aria-hidden="true" class="hash-link" href="#decodedsyncmessage" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>DecodedSyncMessage</strong>: <code>Object</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-declaration-4">Type declaration<a aria-hidden="true" class="hash-link" href="#type-declaration-4" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>changes</code></td><td align="left"><a href="#change"><code>Change</code></a>[]</td></tr><tr><td align="left"><code>have</code></td><td align="left"><code>SyncHave</code>[]</td></tr><tr><td align="left"><code>heads</code></td><td align="left"><a href="#heads"><code>Heads</code></a></td></tr><tr><td align="left"><code>need</code></td><td align="left"><a href="#heads"><code>Heads</code></a></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-8">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-8" title="Direct link to heading">â€‹</a></h4><p>node_modules/@automerge/automerge-wasm/index.d.ts:67</p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="extend">Extend<a aria-hidden="true" class="hash-link" href="#extend" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>Extend</strong>&lt;<code>T</code>&gt;<!-- -->: <code>T</code> extends infer T[] ? <a href="/docs/tsapi/interfaces/List/"><code>List</code></a>&lt;<a href="#extend"><code>Extend</code></a>&lt;<code>T</code>&gt;<!-- -->&gt;<!-- --> : <code>T</code> extends <code>Object</code> ? { <!-- -->[P in keyof T]<!-- -->: Extend&lt;T<!-- -->[P]<!-- -->&gt;<!-- --> } : <code>T</code></p><p>To extend an arbitrary type, we have to turn any arrays that are part of the type&#x27;s definition into Lists.
So we recurse through the properties of T, turning any Arrays we find into Lists.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-3">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-3" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-9">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-9" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L88" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:88</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="heads">Heads<a aria-hidden="true" class="hash-link" href="#heads" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>Heads</strong>: <code>Hash</code>[]</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-10">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-10" title="Direct link to heading">â€‹</a></h4><p>node_modules/@automerge/automerge-wasm/index.d.ts:7</p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="initoptions">InitOptions<a aria-hidden="true" class="hash-link" href="#initoptions" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>InitOptions</strong>&lt;<code>T</code>&gt;<!-- -->: <code>Object</code></p><p>Options to be passed to <a href="#init">init</a> or <a href="#load">load</a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-4">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-4" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="left">The type of the value the document contains</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-declaration-5">Type declaration<a aria-hidden="true" class="hash-link" href="#type-declaration-5" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>actor?</code></td><td align="left"><a href="#actorid"><code>ActorId</code></a></td><td align="left">The actor ID to use for this document, a random one will be generated if <code>null</code> is passed</td></tr><tr><td align="left"><code>freeze?</code></td><td align="left"><code>boolean</code></td><td align="left">-</td></tr><tr><td align="left"><code>patchCallback?</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#patchcallback"><code>PatchCallback</code></a>&lt;<code>T</code>&gt;</td><td align="left">A callback which will be called with the initial patch once the document has finished loading</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-11">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-11" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L125" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:125</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="materializevalue">MaterializeValue<a aria-hidden="true" class="hash-link" href="#materializevalue" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>MaterializeValue</strong>: { <code>[key: string]</code>: <a href="#materializevalue"><code>MaterializeValue</code></a>;  } <!-- -->|<!-- --> <a href="#materializevalue"><code>MaterializeValue</code></a>[] <!-- -->|<!-- --> <code>Value</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-12">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-12" title="Direct link to heading">â€‹</a></h4><p>node_modules/@automerge/automerge-wasm/index.d.ts:9</p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="objid">ObjID<a aria-hidden="true" class="hash-link" href="#objid" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>ObjID</strong>: <code>string</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-13">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-13" title="Direct link to heading">â€‹</a></h4><p>node_modules/@automerge/automerge-wasm/index.d.ts:2</p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="prop">Prop<a aria-hidden="true" class="hash-link" href="#prop" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>Prop</strong>: <code>string</code> <!-- -->|<!-- --> <code>number</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-14">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-14" title="Direct link to heading">â€‹</a></h4><p>node_modules/@automerge/automerge-wasm/index.d.ts:5</p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="scalarvalue">ScalarValue<a aria-hidden="true" class="hash-link" href="#scalarvalue" title="Direct link to heading">â€‹</a></h3><p>Æ¬ <strong>ScalarValue</strong>: <code>string</code> <!-- -->|<!-- --> <code>number</code> <!-- -->|<!-- --> <code>null</code> <!-- -->|<!-- --> <code>boolean</code> <!-- -->|<!-- --> <code>Date</code> <!-- -->|<!-- --> <a href="/docs/tsapi/classes/unstable.Counter/"><code>Counter</code></a> <!-- -->|<!-- --> <code>Uint8Array</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-15">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-15" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/types.ts#L17" target="_blank" rel="noopener noreferrer">automerge/javascript/src/types.ts:17</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="variables">Variables<a aria-hidden="true" class="hash-link" href="#variables" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="uuid">uuid<a aria-hidden="true" class="hash-link" href="#uuid" title="Direct link to heading">â€‹</a></h3><p>â€¢ <code>Const</code> <strong>uuid</strong>: <code>UUIDFactory</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-16">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-16" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/uuid.ts#L14" target="_blank" rel="noopener noreferrer">automerge/javascript/src/uuid.ts:14</a></p><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/uuid.ts#L18" target="_blank" rel="noopener noreferrer">automerge/javascript/src/uuid.ts:18</a></p><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/uuid.ts#L22" target="_blank" rel="noopener noreferrer">automerge/javascript/src/uuid.ts:22</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="functions">Functions<a aria-hidden="true" class="hash-link" href="#functions" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="applychanges">applyChanges<a aria-hidden="true" class="hash-link" href="#applychanges" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>applyChanges</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>, <code>changes</code>, <code>opts?</code>): [<a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;<!-- -->]</p><p>Apply changes received from another document</p><p><code>doc</code> will be updated to reflect the <code>changes</code>. If there are changes which
we do not have dependencies for yet those will be stored in the document and
applied when the depended on changes arrive.</p><p>You can use the <a href="#applyoptions">ApplyOptions</a> to pass a patchcallback which will be
informed of any changes which occur as a result of applying the changes</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-5">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-5" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-1">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-1" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td></tr><tr><td align="left"><code>changes</code></td><td align="left"><code>Uint8Array</code>[]</td></tr><tr><td align="left"><code>opts?</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#applyoptions"><code>ApplyOptions</code></a>&lt;<code>T</code>&gt;</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-1">Returns<a aria-hidden="true" class="hash-link" href="#returns-1" title="Direct link to heading">â€‹</a></h4><p>[<a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;<!-- -->]</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-17">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-17" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L696" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:696</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="change-1">change<a aria-hidden="true" class="hash-link" href="#change-1" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>change</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>, <code>options</code>, <code>callback?</code>): <a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><p>Update the contents of an automerge document</p><p><strong><code>Example</code></strong></p><p>A simple change</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">let doc1 = automerge.init()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc1 = automerge.change(doc1, d =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d.key = &quot;value&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert.equal(doc1.key, &quot;value&quot;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong><code>Example</code></strong></p><p>A change with a message</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">doc1 = automerge.change(doc1, &quot;add another value&quot;, d =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d.key2 = &quot;value2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong><code>Example</code></strong></p><p>A change with a message and a timestamp</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">doc1 = automerge.change(doc1, {message: &quot;add another value&quot;, timestamp: 1640995200}, d =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d.key2 = &quot;value2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong><code>Example</code></strong></p><p>responding to a patch callback</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">let patchedPath</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let patchCallback = patch =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   patchedPath = patch.path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc1 = automerge.change(doc1, {message, &quot;add another value&quot;, timestamp: 1640995200, patchCallback}, d =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d.key2 = &quot;value2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert.equal(patchedPath, [&quot;key2&quot;])</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-6">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-6" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="left">The type of the value contained in the document</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-2">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-2" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td><td align="left">The document to update</td></tr><tr><td align="left"><code>options</code></td><td align="left"><code>string</code> <!-- -->|<!-- --> <a href="/docs/tsapi/namespaces/unstable/#changeoptions"><code>ChangeOptions</code></a>&lt;<code>T</code>&gt;<!-- --> <!-- -->|<!-- --> <a href="/docs/tsapi/namespaces/unstable/#changefn"><code>ChangeFn</code></a>&lt;<code>T</code>&gt;</td><td align="left">Either a message, an <a href="#changeoptions">ChangeOptions</a>, or a <a href="#changefn">ChangeFn</a></td></tr><tr><td align="left"><code>callback?</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#changefn"><code>ChangeFn</code></a>&lt;<code>T</code>&gt;</td><td align="left">A <code>ChangeFn</code> to be used if <code>options</code> was a <code>string</code>  Note that if the second argument is a function it will be used as the <code>ChangeFn</code> regardless of what the third argument is.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-2">Returns<a aria-hidden="true" class="hash-link" href="#returns-2" title="Direct link to heading">â€‹</a></h4><p><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-18">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-18" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L314" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:314</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="clone">clone<a aria-hidden="true" class="hash-link" href="#clone" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>clone</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>, <code>_opts?</code>): <a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><p>Make a full writable copy of an automerge document</p><p><strong><code>Remarks</code></strong></p><p>Unlike <a href="#view">view</a> this function makes a full copy of the memory backing
the document and can thus be passed to <a href="#change-1">change</a>. It also generates a
new actor ID so that changes made in the new document do not create duplicate
sequence numbers with respect to the old document. If you need control over
the actor ID which is generated you can pass the actor ID as the second
argument</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-7">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-7" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="left">The type of the value contained in the document</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-3">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-3" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td><td align="left">The document to clone</td></tr><tr><td align="left"><code>_opts?</code></td><td align="left"><code>string</code> <!-- -->|<!-- --> <a href="#initoptions"><code>InitOptions</code></a>&lt;<code>T</code>&gt;</td><td align="left">Either an actor ID to use for the new doc or an <a href="#initoptions">InitOptions</a></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-3">Returns<a aria-hidden="true" class="hash-link" href="#returns-3" title="Direct link to heading">â€‹</a></h4><p><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-19">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-19" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L222" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:222</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="emptychange">emptyChange<a aria-hidden="true" class="hash-link" href="#emptychange" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>emptyChange</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>, <code>options</code>): <a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><p>Make a change to a document which does not modify the document</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-8">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-8" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-4">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-4" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td><td align="left">The doc to add the empty change to</td></tr><tr><td align="left"><code>options</code></td><td align="left"><code>string</code> <!-- -->|<!-- --> <code>void</code> <!-- -->|<!-- --> <a href="/docs/tsapi/namespaces/unstable/#changeoptions"><code>ChangeOptions</code></a>&lt;<code>T</code>&gt;</td><td align="left">Either a message or a <a href="#changeoptions">ChangeOptions</a> for the new change  Why would you want to do this? One reason might be that you have merged changes from some other peers and you want to generate a change which depends on those merged changes so that you can sign the new change with all of the merged changes as part of the new change.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-4">Returns<a aria-hidden="true" class="hash-link" href="#returns-4" title="Direct link to heading">â€‹</a></h4><p><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-20">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-20" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L402" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:402</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="free">free<a aria-hidden="true" class="hash-link" href="#free" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>free</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>): <code>void</code></p><p>Explicity free the memory backing a document. Note that this is note
necessary in environments which support
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/FinalizationRegistry" target="_blank" rel="noopener noreferrer"><code>FinalizationRegistry</code></a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-9">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-9" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-5">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-5" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-5">Returns<a aria-hidden="true" class="hash-link" href="#returns-5" title="Direct link to heading">â€‹</a></h4><p><code>void</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-21">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-21" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L241" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:241</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="from">from<a aria-hidden="true" class="hash-link" href="#from" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>from</strong>&lt;<code>T</code>&gt;<!-- -->(<code>initialState</code>, <code>_opts?</code>): <a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><p>Create an automerge document from a POJO</p><p><strong><code>Example</code></strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">const doc = automerge.from({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tasks: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {description: &quot;feed dogs&quot;, done: false}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-10">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-10" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="left">extends <code>Record</code>&lt;<code>string</code>, <code>unknown</code>&gt;</td><td align="left">The type of the value passed to <code>from</code> <em>and</em> the type the resulting document will contain</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-6">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-6" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>initialState</code></td><td align="left"><code>T</code> <!-- -->|<!-- --> <a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td><td align="left">The initial state which will be copied into the document</td></tr><tr><td align="left"><code>_opts?</code></td><td align="left"><code>string</code> <!-- -->|<!-- --> <a href="#initoptions"><code>InitOptions</code></a>&lt;<code>T</code>&gt;</td><td align="left">-</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-6">Returns<a aria-hidden="true" class="hash-link" href="#returns-6" title="Direct link to heading">â€‹</a></h4><p><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-22">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-22" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L261" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:261</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getactorid">getActorId<a aria-hidden="true" class="hash-link" href="#getactorid" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>getActorId</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>): <a href="#actorid"><code>ActorId</code></a></p><p>Get the actor ID associated with the document</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-11">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-11" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-7">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-7" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-7">Returns<a aria-hidden="true" class="hash-link" href="#returns-7" title="Direct link to heading">â€‹</a></h4><p><a href="#actorid"><code>ActorId</code></a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-23">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-23" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L553" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:553</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getallchanges">getAllChanges<a aria-hidden="true" class="hash-link" href="#getallchanges" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>getAllChanges</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>): <a href="#change"><code>Change</code></a>[]</p><p>Get all the changes in a document</p><p>This is different to <a href="#save">save</a> because the output is an array of changes
which can be individually applied via <a href="#applychanges">applyChanges</a>`</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-12">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-12" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-8">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-8" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-8">Returns<a aria-hidden="true" class="hash-link" href="#returns-8" title="Direct link to heading">â€‹</a></h4><p><a href="#change"><code>Change</code></a>[]</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-24">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-24" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L680" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:680</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getchanges">getChanges<a aria-hidden="true" class="hash-link" href="#getchanges" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>getChanges</strong>&lt;<code>T</code>&gt;<!-- -->(<code>oldState</code>, <code>newState</code>): <a href="#change"><code>Change</code></a>[]</p><p>Get the changes which are in <code>newState</code> but not in <code>oldState</code>. The returned
changes can be loaded in <code>oldState</code> via <a href="#applychanges">applyChanges</a>.</p><p>Note that this will crash if there are changes in <code>oldState</code> which are not in <code>newState</code>.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-13">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-13" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-9">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-9" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>oldState</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td></tr><tr><td align="left"><code>newState</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-9">Returns<a aria-hidden="true" class="hash-link" href="#returns-9" title="Direct link to heading">â€‹</a></h4><p><a href="#change"><code>Change</code></a>[]</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-25">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-25" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L668" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:668</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getconflicts">getConflicts<a aria-hidden="true" class="hash-link" href="#getconflicts" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>getConflicts</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>, <code>prop</code>): <a href="#conflicts"><code>Conflicts</code></a> <!-- -->|<!-- --> <code>undefined</code></p><p>Get the conflicts associated with a property</p><p>The values of properties in a map in automerge can be conflicted if there
are concurrent &quot;put&quot; operations to the same key. Automerge chooses one value
arbitrarily (but deterministically, any two nodes who have the same set of
changes will choose the same value) from the set of conflicting values to
present as the value of the key.</p><p>Sometimes you may want to examine these conflicts, in this case you can use
<a href="#getconflicts">getConflicts</a> to get the conflicts for the key.</p><p><strong><code>Example</code></strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">import * as automerge from &quot;@automerge/automerge&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type Profile = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pets: Array&lt;{name: string, type: string}&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let doc1 = automerge.init&lt;Profile&gt;(&quot;aaaa&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc1 = automerge.change(doc1, d =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d.pets = [{name: &quot;Lassie&quot;, type: &quot;dog&quot;}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let doc2 = automerge.init&lt;Profile&gt;(&quot;bbbb&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc2 = automerge.merge(doc2, automerge.clone(doc1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc2 = automerge.change(doc2, d =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d.pets[0].name = &quot;Beethoven&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc1 = automerge.change(doc1, d =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d.pets[0].name = &quot;Babe&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const doc3 = automerge.merge(doc1, doc2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Note that here we pass `doc3.pets`, not `doc3`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let conflicts = automerge.getConflicts(doc3.pets[0], &quot;name&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// The two conflicting values are the keys of the conflicts object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">assert.deepEqual(Object.values(conflicts), [&quot;Babe&quot;, Beethoven&quot;])</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-14">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-14" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-10">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-10" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td></tr><tr><td align="left"><code>prop</code></td><td align="left"><a href="#prop"><code>Prop</code></a></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-10">Returns<a aria-hidden="true" class="hash-link" href="#returns-10" title="Direct link to heading">â€‹</a></h4><p><a href="#conflicts"><code>Conflicts</code></a> <!-- -->|<!-- --> <code>undefined</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-26">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-26" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L614" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:614</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getheads">getHeads<a aria-hidden="true" class="hash-link" href="#getheads" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>getHeads</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>): <a href="#heads"><code>Heads</code></a></p><p>Get the hashes of the heads of this document</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-15">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-15" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-11">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-11" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-11">Returns<a aria-hidden="true" class="hash-link" href="#returns-11" title="Direct link to heading">â€‹</a></h4><p><a href="#heads"><code>Heads</code></a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-27">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-27" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L889" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:889</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getlastlocalchange">getLastLocalChange<a aria-hidden="true" class="hash-link" href="#getlastlocalchange" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>getLastLocalChange</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>): <a href="#change"><code>Change</code></a> <!-- -->|<!-- --> <code>undefined</code></p><p>Get the binary representation of the last change which was made to this doc</p><p>This is most useful when staying in sync with other peers, every time you
make a change locally via <a href="#change-1">change</a> you immediately call <a href="#getlastlocalchange">getLastLocalChange</a> and send the result over the network to other peers.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-16">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-16" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-12">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-12" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-12">Returns<a aria-hidden="true" class="hash-link" href="#returns-12" title="Direct link to heading">â€‹</a></h4><p><a href="#change"><code>Change</code></a> <!-- -->|<!-- --> <code>undefined</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-28">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-28" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L637" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:637</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getmissingdeps">getMissingDeps<a aria-hidden="true" class="hash-link" href="#getmissingdeps" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>getMissingDeps</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>, <code>heads</code>): <a href="#heads"><code>Heads</code></a></p><p>Get any changes in <code>doc</code> which are not dependencies of <code>heads</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-17">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-17" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-13">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-13" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td></tr><tr><td align="left"><code>heads</code></td><td align="left"><a href="#heads"><code>Heads</code></a></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-13">Returns<a aria-hidden="true" class="hash-link" href="#returns-13" title="Direct link to heading">â€‹</a></h4><p><a href="#heads"><code>Heads</code></a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-29">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-29" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L881" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:881</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getobjectid">getObjectId<a aria-hidden="true" class="hash-link" href="#getobjectid" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>getObjectId</strong>(<code>doc</code>, <code>prop?</code>): <a href="#objid"><code>ObjID</code></a> <!-- -->|<!-- --> <code>null</code></p><p>Return the object ID of an arbitrary javascript value</p><p>This is useful to determine if something is actually an automerge document,
if <code>doc</code> is not an automerge document this will return null.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-14">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-14" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><code>any</code></td></tr><tr><td align="left"><code>prop?</code></td><td align="left"><a href="#prop"><code>Prop</code></a></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-14">Returns<a aria-hidden="true" class="hash-link" href="#returns-14" title="Direct link to heading">â€‹</a></h4><p><a href="#objid"><code>ObjID</code></a> <!-- -->|<!-- --> <code>null</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-30">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-30" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L649" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:649</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="init">init<a aria-hidden="true" class="hash-link" href="#init" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>init</strong>&lt;<code>T</code>&gt;<!-- -->(<code>_opts?</code>): <a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><p>Create a new automerge document</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-18">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-18" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="left">The type of value contained in the document. This will be the     type that is passed to the change closure in <a href="#change-1">change</a></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-15">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-15" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>_opts?</code></td><td align="left"><code>string</code> <!-- -->|<!-- --> <a href="#initoptions"><code>InitOptions</code></a>&lt;<code>T</code>&gt;</td><td align="left">Either an actorId or an <a href="#initoptions">InitOptions</a> (which may     contain an actorId). If this is null the document will be initialised with a     random actor ID</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-15">Returns<a aria-hidden="true" class="hash-link" href="#returns-15" title="Direct link to heading">â€‹</a></h4><p><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-31">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-31" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L157" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:157</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="isautomerge">isAutomerge<a aria-hidden="true" class="hash-link" href="#isautomerge" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>isAutomerge</strong>(<code>doc</code>): <code>boolean</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-16">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-16" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><code>unknown</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-16">Returns<a aria-hidden="true" class="hash-link" href="#returns-16" title="Direct link to heading">â€‹</a></h4><p><code>boolean</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-32">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-32" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L909" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:909</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="load">load<a aria-hidden="true" class="hash-link" href="#load" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>load</strong>&lt;<code>T</code>&gt;<!-- -->(<code>data</code>, <code>_opts?</code>): <a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><p>Load an automerge document from a compressed document produce by <a href="#save">save</a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-19">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-19" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="left">The type of the value which is contained in the document.                Note that no validation is done to make sure this type is in                fact the type of the contained value so be a bit careful</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-17">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-17" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>data</code></td><td align="left"><code>Uint8Array</code></td><td align="left">The compressed document</td></tr><tr><td align="left"><code>_opts?</code></td><td align="left"><code>string</code> <!-- -->|<!-- --> <a href="#initoptions"><code>InitOptions</code></a>&lt;<code>T</code>&gt;</td><td align="left">Either an actor ID or some <a href="#initoptions">InitOptions</a>, if the actor                ID is null a random actor ID will be created  Note that <code>load</code> will throw an error if passed incomplete content (for example if you are receiving content over the network and don&#x27;t know if you have the complete document yet). If you need to handle incomplete content use <a href="#init">init</a> followed by <a href="#loadincremental">loadIncremental</a>.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-17">Returns<a aria-hidden="true" class="hash-link" href="#returns-17" title="Direct link to heading">â€‹</a></h4><p><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-33">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-33" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L444" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:444</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="loadincremental">loadIncremental<a aria-hidden="true" class="hash-link" href="#loadincremental" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>loadIncremental</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>, <code>data</code>, <code>opts?</code>): <a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><p>Load changes produced by saveIncremental, or partial changes</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-20">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-20" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="left">The type of the value which is contained in the document.                Note that no validation is done to make sure this type is in                fact the type of the contained value so be a bit careful</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-18">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-18" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td><td align="left">-</td></tr><tr><td align="left"><code>data</code></td><td align="left"><code>Uint8Array</code></td><td align="left">The compressedchanges</td></tr><tr><td align="left"><code>opts?</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#applyoptions"><code>ApplyOptions</code></a>&lt;<code>T</code>&gt;</td><td align="left">an <a href="#applyoptions">ApplyOptions</a>  This function is useful when staying up to date with a connected peer. Perhaps the other end sent you a full compresed document which you loaded with <a href="#load">load</a> and they&#x27;re sending you the result of <a href="#getlastlocalchange">getLastLocalChange</a> every time they make a change.  Note that this function will succesfully load the results of <a href="#save">save</a> as well as <a href="#getlastlocalchange">getLastLocalChange</a> or any other incremental change.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-18">Returns<a aria-hidden="true" class="hash-link" href="#returns-18" title="Direct link to heading">â€‹</a></h4><p><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-34">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-34" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L487" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:487</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="merge">merge<a aria-hidden="true" class="hash-link" href="#merge" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>merge</strong>&lt;<code>T</code>&gt;<!-- -->(<code>local</code>, <code>remote</code>): <a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><p>Merge <code>local</code> into <code>remote</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-21">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-21" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="left">The type of values contained in each document</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-19">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-19" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>local</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td><td align="left">The document to merge changes into</td></tr><tr><td align="left"><code>remote</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td><td align="left">The document to merge changes from</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-19">Returns<a aria-hidden="true" class="hash-link" href="#returns-19" title="Direct link to heading">â€‹</a></h4><p><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><ul><li>The merged document</li></ul><p>Often when you are merging documents you will also need to clone them. Both
arguments to <code>merge</code> are frozen after the call so you can no longer call
mutating methods (such as <a href="#change-1">change</a>) on them. The symtom of this will be
an error which says &quot;Attempting to change an out of date document&quot;. To
overcome this call <a href="#clone">clone</a> on the argument before passing it to <a href="#merge">merge</a>.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-35">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-35" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L535" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:535</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="save">save<a aria-hidden="true" class="hash-link" href="#save" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>save</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>): <code>Uint8Array</code></p><p>Export the contents of a document to a compressed format</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-22">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-22" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-20">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-20" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td><td align="left">The doc to save  The returned bytes can be passed to <a href="#load">load</a> or <a href="#loadincremental">loadIncremental</a></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-20">Returns<a aria-hidden="true" class="hash-link" href="#returns-20" title="Direct link to heading">â€‹</a></h4><p><code>Uint8Array</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-36">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-36" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L516" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:516</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="view">view<a aria-hidden="true" class="hash-link" href="#view" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>view</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>, <code>heads</code>): <a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><p>Make an immutable view of an automerge document as at <code>heads</code></p><p><strong><code>Remarks</code></strong></p><p>The document returned from this function cannot be passed to <a href="#change-1">change</a>.
This is because it shares the same underlying memory as <code>doc</code>, but it is
consequently a very cheap copy.</p><p>Note that this function will throw an error if any of the hashes in <code>heads</code>
are not in the document.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-23">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-23" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="left">The type of the value contained in the document</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-21">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-21" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td><td align="left">The document to create a view of</td></tr><tr><td align="left"><code>heads</code></td><td align="left"><a href="#heads"><code>Heads</code></a></td><td align="left">The hashes of the heads to create a view at</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-21">Returns<a aria-hidden="true" class="hash-link" href="#returns-21" title="Direct link to heading">â€‹</a></h4><p><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-37">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-37" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L197" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:197</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="sync">sync<a aria-hidden="true" class="hash-link" href="#sync" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="decodesyncstate">decodeSyncState<a aria-hidden="true" class="hash-link" href="#decodesyncstate" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>decodeSyncState</strong>(<code>state</code>): <a href="/docs/tsapi/interfaces/SyncState/"><code>SyncState</code></a></p><p>Decode some binary data into a <a href="/docs/tsapi/interfaces/SyncState/">SyncState</a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-22">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-22" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>state</code></td><td align="left"><code>Uint8Array</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-22">Returns<a aria-hidden="true" class="hash-link" href="#returns-22" title="Direct link to heading">â€‹</a></h4><p><a href="/docs/tsapi/interfaces/SyncState/"><code>SyncState</code></a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-38">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-38" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L771" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:771</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="encodesyncstate">encodeSyncState<a aria-hidden="true" class="hash-link" href="#encodesyncstate" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>encodeSyncState</strong>(<code>state</code>): <code>Uint8Array</code></p><p>encode a <a href="/docs/tsapi/interfaces/SyncState/">SyncState</a> into binary to send over the network</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-23">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-23" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th></tr></thead><tbody><tr><td align="left"><code>state</code></td><td align="left"><a href="/docs/tsapi/interfaces/SyncState/"><code>SyncState</code></a></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-23">Returns<a aria-hidden="true" class="hash-link" href="#returns-23" title="Direct link to heading">â€‹</a></h4><p><code>Uint8Array</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-39">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-39" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L759" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:759</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="generatesyncmessage">generateSyncMessage<a aria-hidden="true" class="hash-link" href="#generatesyncmessage" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>generateSyncMessage</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>, <code>inState</code>): [<a href="/docs/tsapi/interfaces/SyncState/"><code>SyncState</code></a>, <a href="/docs/tsapi/namespaces/unstable/#syncmessage"><code>SyncMessage</code></a> <!-- -->|<!-- --> <code>null</code>]</p><p>Generate a sync message to send to the peer represented by <code>inState</code></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-24">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-24" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-24">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-24" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td><td align="left">The doc to generate messages about</td></tr><tr><td align="left"><code>inState</code></td><td align="left"><a href="/docs/tsapi/interfaces/SyncState/"><code>SyncState</code></a></td><td align="left">The <a href="/docs/tsapi/interfaces/SyncState/">SyncState</a> representing the peer we are talking to</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-24">Returns<a aria-hidden="true" class="hash-link" href="#returns-24" title="Direct link to heading">â€‹</a></h4><p>[<a href="/docs/tsapi/interfaces/SyncState/"><code>SyncState</code></a>, <a href="/docs/tsapi/namespaces/unstable/#syncmessage"><code>SyncMessage</code></a> <!-- -->|<!-- --> <code>null</code>]</p><p>An array of <code>[newSyncState, syncMessage | null]</code> where
<code>newSyncState</code> should replace <code>inState</code> and <code>syncMessage</code> should be sent to
the peer if it is not null. If <code>syncMessage</code> is null then we are up to date.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-40">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-40" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L789" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:789</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="initsyncstate">initSyncState<a aria-hidden="true" class="hash-link" href="#initsyncstate" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>initSyncState</strong>(): <a href="/docs/tsapi/interfaces/SyncState/"><code>SyncState</code></a></p><p>Create a new, blank <a href="/docs/tsapi/interfaces/SyncState/">SyncState</a></p><p>When communicating with a peer for the first time use this to generate a new
<a href="/docs/tsapi/interfaces/SyncState/">SyncState</a> for them</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-25">Returns<a aria-hidden="true" class="hash-link" href="#returns-25" title="Direct link to heading">â€‹</a></h4><p><a href="/docs/tsapi/interfaces/SyncState/"><code>SyncState</code></a></p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-41">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-41" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L854" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:854</a></p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="receivesyncmessage">receiveSyncMessage<a aria-hidden="true" class="hash-link" href="#receivesyncmessage" title="Direct link to heading">â€‹</a></h3><p>â–¸ <strong>receiveSyncMessage</strong>&lt;<code>T</code>&gt;<!-- -->(<code>doc</code>, <code>inState</code>, <code>message</code>, <code>opts?</code>): [<a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;<!-- -->, <a href="/docs/tsapi/interfaces/SyncState/"><code>SyncState</code></a>, <code>null</code>]</p><p>Update a document and our sync state on receiving a sync message</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="type-parameters-25">Type parameters<a aria-hidden="true" class="hash-link" href="#type-parameters-25" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th></tr></thead><tbody><tr><td align="left"><code>T</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-25">Parameters<a aria-hidden="true" class="hash-link" href="#parameters-25" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>doc</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;</td><td align="left">The doc the sync message is about</td></tr><tr><td align="left"><code>inState</code></td><td align="left"><a href="/docs/tsapi/interfaces/SyncState/"><code>SyncState</code></a></td><td align="left">The <a href="/docs/tsapi/interfaces/SyncState/">SyncState</a> for the peer we are communicating with</td></tr><tr><td align="left"><code>message</code></td><td align="left"><code>Uint8Array</code></td><td align="left">The message which was received</td></tr><tr><td align="left"><code>opts?</code></td><td align="left"><a href="/docs/tsapi/namespaces/unstable/#applyoptions"><code>ApplyOptions</code></a>&lt;<code>T</code>&gt;</td><td align="left">Any ApplyOptions, used for passing a                  <a href="#patchcallback">PatchCallback</a> which will be informed of any changes                  in <code>doc</code> which occur because of the received sync message.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="returns-26">Returns<a aria-hidden="true" class="hash-link" href="#returns-26" title="Direct link to heading">â€‹</a></h4><p>[<a href="/docs/tsapi/namespaces/unstable/#doc"><code>Doc</code></a>&lt;<code>T</code>&gt;<!-- -->, <a href="/docs/tsapi/interfaces/SyncState/"><code>SyncState</code></a>, <code>null</code>]</p><p>An array of <code>[newDoc, newSyncState, syncMessage | null]</code> where
<code>newDoc</code> is the updated state of <code>doc</code>, <code>newSyncState</code> should replace
<code>inState</code> and <code>syncMessage</code> should be sent to the peer if it is not null. If
<code>syncMessage</code> is null then we are up to date.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="defined-in-42">Defined in<a aria-hidden="true" class="hash-link" href="#defined-in-42" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/automerge/automerge-rs/blob/89a08662/javascript/src/stable.ts#L817" target="_blank" rel="noopener noreferrer">automerge/javascript/src/stable.ts:817</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/how-it-works/sync/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Sync Protocol</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/tsapi/namespaces/unstable/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">unstable<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#creating-and-modifying-a-document" class="table-of-contents__link toc-highlight">Creating and modifying a document</a></li><li><a href="#applying-changes-from-another-document" class="table-of-contents__link toc-highlight">Applying changes from another document</a></li><li><a href="#saving-and-loading-documents" class="table-of-contents__link toc-highlight">Saving and loading documents</a></li><li><a href="#viewing-different-versions-of-a-document" class="table-of-contents__link toc-highlight">Viewing different versions of a document</a></li><li><a href="#syncing" class="table-of-contents__link toc-highlight">Syncing</a></li><li><a href="#conflicts" class="table-of-contents__link toc-highlight">Conflicts</a></li><li><a href="#actor-ids" class="table-of-contents__link toc-highlight">Actor IDs</a></li><li><a href="#listening-to-patches" class="table-of-contents__link toc-highlight">Listening to patches</a></li><li><a href="#cloning" class="table-of-contents__link toc-highlight">Cloning</a></li><li><a href="#the-unstable-module" class="table-of-contents__link toc-highlight">The unstable module</a></li><li><a href="#namespaces" class="table-of-contents__link toc-highlight">Namespaces</a></li><li><a href="#classes" class="table-of-contents__link toc-highlight">Classes</a></li><li><a href="#interfaces" class="table-of-contents__link toc-highlight">Interfaces</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a><ul><li><a href="#counter" class="table-of-contents__link toc-highlight">Counter</a></li><li><a href="#delpatch" class="table-of-contents__link toc-highlight">DelPatch</a></li><li><a href="#doc" class="table-of-contents__link toc-highlight">Doc</a></li><li><a href="#float64" class="table-of-contents__link toc-highlight">Float64</a></li><li><a href="#incpatch" class="table-of-contents__link toc-highlight">IncPatch</a></li><li><a href="#insertpatch" class="table-of-contents__link toc-highlight">InsertPatch</a></li><li><a href="#int" class="table-of-contents__link toc-highlight">Int</a></li><li><a href="#patch" class="table-of-contents__link toc-highlight">Patch</a></li><li><a href="#patchcallback" class="table-of-contents__link toc-highlight">PatchCallback</a></li><li><a href="#putpatch" class="table-of-contents__link toc-highlight">PutPatch</a></li><li><a href="#splicetextpatch" class="table-of-contents__link toc-highlight">SpliceTextPatch</a></li><li><a href="#syncmessage" class="table-of-contents__link toc-highlight">SyncMessage</a></li><li><a href="#uint" class="table-of-contents__link toc-highlight">Uint</a></li></ul></li><li><a href="#type-aliases" class="table-of-contents__link toc-highlight">Type Aliases</a><ul><li><a href="#actorid" class="table-of-contents__link toc-highlight">ActorId</a></li><li><a href="#applyoptions" class="table-of-contents__link toc-highlight">ApplyOptions</a></li><li><a href="#automergevalue" class="table-of-contents__link toc-highlight">AutomergeValue</a></li><li><a href="#change" class="table-of-contents__link toc-highlight">Change</a></li><li><a href="#changefn" class="table-of-contents__link toc-highlight">ChangeFn</a></li><li><a href="#changeoptions" class="table-of-contents__link toc-highlight">ChangeOptions</a></li><li><a href="#conflicts-1" class="table-of-contents__link toc-highlight">Conflicts</a></li><li><a href="#decodedchange" class="table-of-contents__link toc-highlight">DecodedChange</a></li><li><a href="#decodedsyncmessage" class="table-of-contents__link toc-highlight">DecodedSyncMessage</a></li><li><a href="#extend" class="table-of-contents__link toc-highlight">Extend</a></li><li><a href="#heads" class="table-of-contents__link toc-highlight">Heads</a></li><li><a href="#initoptions" class="table-of-contents__link toc-highlight">InitOptions</a></li><li><a href="#materializevalue" class="table-of-contents__link toc-highlight">MaterializeValue</a></li><li><a href="#objid" class="table-of-contents__link toc-highlight">ObjID</a></li><li><a href="#prop" class="table-of-contents__link toc-highlight">Prop</a></li><li><a href="#scalarvalue" class="table-of-contents__link toc-highlight">ScalarValue</a></li></ul></li><li><a href="#variables" class="table-of-contents__link toc-highlight">Variables</a><ul><li><a href="#uuid" class="table-of-contents__link toc-highlight">uuid</a></li></ul></li><li><a href="#functions" class="table-of-contents__link toc-highlight">Functions</a><ul><li><a href="#applychanges" class="table-of-contents__link toc-highlight">applyChanges</a></li><li><a href="#change-1" class="table-of-contents__link toc-highlight">change</a></li><li><a href="#clone" class="table-of-contents__link toc-highlight">clone</a></li><li><a href="#emptychange" class="table-of-contents__link toc-highlight">emptyChange</a></li><li><a href="#free" class="table-of-contents__link toc-highlight">free</a></li><li><a href="#from" class="table-of-contents__link toc-highlight">from</a></li><li><a href="#getactorid" class="table-of-contents__link toc-highlight">getActorId</a></li><li><a href="#getallchanges" class="table-of-contents__link toc-highlight">getAllChanges</a></li><li><a href="#getchanges" class="table-of-contents__link toc-highlight">getChanges</a></li><li><a href="#getconflicts" class="table-of-contents__link toc-highlight">getConflicts</a></li><li><a href="#getheads" class="table-of-contents__link toc-highlight">getHeads</a></li><li><a href="#getlastlocalchange" class="table-of-contents__link toc-highlight">getLastLocalChange</a></li><li><a href="#getmissingdeps" class="table-of-contents__link toc-highlight">getMissingDeps</a></li><li><a href="#getobjectid" class="table-of-contents__link toc-highlight">getObjectId</a></li><li><a href="#init" class="table-of-contents__link toc-highlight">init</a></li><li><a href="#isautomerge" class="table-of-contents__link toc-highlight">isAutomerge</a></li><li><a href="#load" class="table-of-contents__link toc-highlight">load</a></li><li><a href="#loadincremental" class="table-of-contents__link toc-highlight">loadIncremental</a></li><li><a href="#merge" class="table-of-contents__link toc-highlight">merge</a></li><li><a href="#save" class="table-of-contents__link toc-highlight">save</a></li><li><a href="#view" class="table-of-contents__link toc-highlight">view</a></li></ul></li><li><a href="#sync" class="table-of-contents__link toc-highlight">sync</a><ul><li><a href="#decodesyncstate" class="table-of-contents__link toc-highlight">decodeSyncState</a></li><li><a href="#encodesyncstate" class="table-of-contents__link toc-highlight">encodeSyncState</a></li><li><a href="#generatesyncmessage" class="table-of-contents__link toc-highlight">generateSyncMessage</a></li><li><a href="#initsyncstate" class="table-of-contents__link toc-highlight">initSyncState</a></li><li><a href="#receivesyncmessage" class="table-of-contents__link toc-highlight">receiveSyncMessage</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/tutorial/introduction/">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://join.slack.com/t/automerge/shared_invite/zt-e4p3760n-kKh7r3KRH1YwwNfiZM8ktw" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://inkandswitch.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Ink &amp; Switch<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/automerge/automerge" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Automerge contributors. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9e1d470a.js"></script>
<script src="/assets/js/main.f8e721d1.js"></script>
</body>
</html>